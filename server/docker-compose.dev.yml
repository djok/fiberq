# Development override - use with:
# docker compose -f docker-compose.yml -f docker-compose.dev.yml up
services:
  postgis:
    ports:
      - "5433:5432"

  api:
    build:
      context: ./api
      dockerfile: Dockerfile
    volumes:
      - ./api:/app
    environment:
      LOG_LEVEL: debug
    command: ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000", "--reload"]

  nginx:
    ports:
      - "8080:80"
    # Skip HTTPS in dev
    volumes:
      - ./nginx/nginx.dev.conf:/etc/nginx/nginx.conf:ro
      - photos:/app/storage/photos:ro

  pgadmin:
    ports:
      - "5050:80"
    profiles: []  # Always start in dev

volumes:
  photos:
    name: fiberq_photos
